This pattern uses the granularity concept in a way to align multiple CTEs to the same granularity (if the underlying tables have different ones) before joining. For example if a table has one row per minute and the other has one row per hour, you cannot join them without messing up the logic so you have to align the granulaity for both to the hour level (by aggregating from minutes to hours) and then you can join.